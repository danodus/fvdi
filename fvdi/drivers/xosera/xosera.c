#include "xosera.h"
short colours[] = {
    1000, 1000, 1000, 0, 0, 0, 1000, 1, 0, 0, 1000, 0,
    0, 0, 1000, 0, 1000, 1000, 1000, 1000, 0, 1000, 0, 1000,
    733, 733, 733, 533, 533, 533, 667, 0, 0, 0, 667, 0,
    0, 0, 667, 0, 667, 667, 667, 667, 0, 667, 0, 667,
    1000, 1000, 1000, 933, 933, 933, 867, 867, 867, 800, 800, 800,
    733, 733, 733, 667, 667, 667, 600, 600, 600, 533, 533, 533,
    467, 467, 467, 400, 400, 400, 333, 333, 333, 267, 267, 267,
    200, 200, 200, 133, 133, 133, 67, 67, 67, 0, 0, 0,
    1000, 0, 0, 1000, 0, 67, 1000, 0, 133, 1000, 0, 200,
    1000, 0, 267, 1000, 0, 333, 1000, 0, 400, 1000, 0, 467,
    1000, 0, 533, 1000, 0, 600, 1000, 0, 667, 1000, 0, 733,
    1000, 0, 800, 1000, 0, 867, 1000, 0, 933, 1000, 0, 1000,
    933, 0, 1000, 867, 0, 1000, 800, 0, 1000, 733, 0, 1000,
    667, 0, 1000, 600, 0, 1000, 533, 0, 1000, 467, 0, 1000,
    400, 0, 1000, 333, 0, 1000, 267, 0, 1000, 200, 0, 1000,
    133, 0, 1000, 67, 0, 1000, 0, 0, 1000, 0, 67, 1000,
    0, 133, 1000, 0, 200, 1000, 0, 267, 1000, 0, 333, 1000,
    0, 400, 1000, 0, 467, 1000, 0, 533, 1000, 0, 600, 1000,
    0, 667, 1000, 0, 733, 1000, 0, 800, 1000, 0, 867, 1000,
    0, 933, 1000, 0, 1000, 1000, 0, 1000, 933, 0, 1000, 867,
    0, 1000, 800, 0, 1000, 733, 0, 1000, 667, 0, 1000, 600,
    0, 1000, 533, 0, 1000, 467, 0, 1000, 400, 0, 1000, 333,
    0, 1000, 267, 0, 1000, 200, 0, 1000, 133, 0, 1000, 67,
    0, 1000, 0, 67, 1000, 0, 133, 1000, 0, 200, 1000, 0,
    267, 1000, 0, 333, 1000, 0, 400, 1000, 0, 467, 1000, 0,
    533, 1000, 0, 600, 1000, 0, 667, 1000, 0, 733, 1000, 0,
    800, 1000, 0, 867, 1000, 0, 933, 1000, 0, 1000, 1000, 0,
    1000, 933, 0, 1000, 867, 0, 1000, 800, 0, 1000, 733, 0,
    1000, 667, 0, 1000, 600, 0, 1000, 533, 0, 1000, 467, 0,
    1000, 400, 0, 1000, 333, 0, 1000, 267, 0, 1000, 200, 0,
    1000, 133, 0, 1000, 67, 0, 733, 0, 0, 733, 0, 67,
    733, 0, 133, 733, 0, 200, 733, 0, 267, 733, 0, 333,
    733, 0, 400, 733, 0, 467, 733, 0, 533, 733, 0, 600,
    733, 0, 667, 733, 0, 733, 667, 0, 733, 600, 0, 733,
    533, 0, 733, 467, 0, 733, 400, 0, 733, 333, 0, 733,
    267, 0, 733, 200, 0, 733, 133, 0, 733, 67, 0, 733,
    0, 0, 733, 0, 67, 733, 0, 133, 733, 0, 200, 733,
    0, 267, 733, 0, 333, 733, 0, 400, 733, 0, 467, 733,
    0, 533, 733, 0, 600, 733, 0, 667, 733, 0, 733, 733,
    0, 733, 667, 0, 733, 600, 0, 733, 533, 0, 733, 467,
    0, 733, 400, 0, 733, 333, 0, 733, 267, 0, 733, 200,
    0, 733, 133, 0, 733, 67, 0, 733, 0, 67, 733, 0,
    133, 733, 0, 200, 733, 0, 267, 733, 0, 333, 733, 0,
    400, 733, 0, 467, 733, 0, 533, 733, 0, 600, 733, 0,
    667, 733, 0, 733, 733, 0, 733, 667, 0, 733, 600, 0,
    733, 533, 0, 733, 467, 0, 733, 400, 0, 733, 333, 0,
    733, 267, 0, 733, 200, 0, 733, 133, 0, 733, 67, 0,
    467, 0, 0, 467, 0, 67, 467, 0, 133, 467, 0, 200,
    467, 0, 267, 467, 0, 333, 467, 0, 400, 467, 0, 467,
    400, 0, 467, 333, 0, 467, 267, 0, 467, 200, 0, 467,
    133, 0, 467, 67, 0, 467, 0, 0, 467, 0, 67, 467,
    0, 133, 467, 0, 200, 467, 0, 267, 467, 0, 333, 467,
    0, 400, 467, 0, 467, 467, 0, 467, 400, 0, 467, 333,
    0, 467, 267, 0, 467, 200, 0, 467, 133, 0, 467, 67,
    0, 467, 0, 67, 467, 0, 133, 467, 0, 200, 467, 0,
    267, 467, 0, 333, 467, 0, 400, 467, 0, 467, 467, 0,
    467, 400, 0, 467, 333, 0, 467, 267, 0, 467, 200, 0,
    467, 133, 0, 467, 67, 0, 267, 0, 0, 267, 0, 67,
    267, 0, 133, 267, 0, 200, 267, 0, 267, 200, 0, 267,
    133, 0, 267, 67, 0, 267, 0, 0, 267, 0, 67, 267,
    0, 133, 267, 0, 200, 267, 0, 267, 267, 0, 267, 200,
    0, 267, 133, 0, 267, 67, 0, 267, 0, 67, 267, 0,
    133, 267, 0, 200, 267, 0, 267, 267, 0, 267, 200, 0,
    267, 133, 0, 267, 67, 0, 1000, 1000, 1000, 0, 0, 0};

void xosera_palette_register_write(uint8_t palette, uint16_t data)
{
    xv_prep();
    xm_setw(WR_XADDR, XR_COLOR_ADDR | palette);
    xm_setw(XDATA, data);
}

// A lookup table to take a color in 4 bits and expand it to sixteen, e.g A => 0xAAAA
uint16_t expanded_color[16] = {
        0x0000, 0x1111, 0x2222, 0x3333, 0x4444, 0x5555, 0x6666, 0x7777,
        0x8888, 0x9999, 0xAAAA, 0xBBBB, 0xCCCC, 0xDDDD, 0xEEEE, 0xFFFF
};
